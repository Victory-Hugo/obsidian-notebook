<!DOCTYPE html> <html><head>
		<title>VCF文件初识</title>
		<base href="../">
		<meta id="root-path" root-path="../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="科研思路 - VCF文件初识">
		<meta property="og:title" content="VCF文件初识">
		<meta property="og:description" content="科研思路 - VCF文件初识">
		<meta property="og:type" content="website">
		<meta property="og:url" content="linux和bash脚本/vcf文件初识.html">
		<meta property="og:image" content="https://picturerealm.oss-cn-chengdu.aliyuncs.com/obsidian/202401230846638.png">
		<meta property="og:site_name" content="科研思路">
		<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.4.0/pixi.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="https://cdn.jsdelivr.net/npm/minisearch@6.3.0/dist/umd/index.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="stylesheet" href="lib/styles/theme.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/supported-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/supported-plugins.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript></head><body class="publish css-settings-manager theme-dark show-inline-title show-ribbon h2-underline"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles">mjx-c.mjx-c1D449.TEX-I::before{padding:.683em .769em .022em 0;content:"V"}mjx-c.mjx-c1D43C.TEX-I::before{padding:.683em .504em 0 0;content:"I"}mjx-c.mjx-c2212::before{padding:.583em .778em .082em 0;content:"−"}mjx-c.mjx-c36::before{padding:.666em .5em .022em 0;content:"6"}mjx-c.mjx-c33::before{padding:.665em .5em .022em 0;content:"3"}mjx-c.mjx-c37::before{padding:.676em .5em .022em 0;content:"7"}mjx-c.mjx-c3E::before{padding:.54em .778em .04em 0;content:">"}mjx-c.mjx-c1D44D.TEX-I::before{padding:.683em .723em 0 0;content:"Z"}mjx-c.mjx-c3C::before{padding:.54em .778em .04em 0;content:"<"}mjx-c.mjx-c35::before{padding:.666em .5em .022em 0;content:"5"}mjx-texatom{display:inline-block;text-align:left}mjx-c.mjx-c5B::before{padding:.75em .278em .25em 0;content:"["}mjx-c.mjx-c30::before{padding:.666em .5em .022em 0;content:"0"}mjx-c.mjx-c2C::before{padding:.121em .278em .194em 0;content:","}mjx-c.mjx-c5D::before{padding:.75em .278em .25em 0;content:"]"}mjx-c.mjx-c1D453.TEX-I::before{padding:.705em .55em .205em 0;content:"f"}mjx-c.mjx-c2035.TEX-A::before{padding:.56em .275em 0 0;content:"‵"}mjx-c.mjx-c1D45A.TEX-I::before{padding:.442em .878em .011em 0;content:"m"}mjx-c.mjx-c1D45D.TEX-I::before{padding:.442em .503em .194em 0;content:"p"}mjx-c.mjx-c2E::before{padding:.12em .278em 0 0;content:"."}mjx-c.mjx-c1D465.TEX-I::before{padding:.442em .572em .011em 0;content:"x"}mjx-msup{display:inline-block;text-align:left}mjx-c.mjx-c1D445.TEX-I::before{padding:.683em .759em .021em 0;content:"R"}mjx-c.mjx-c32::before{padding:.666em .5em 0 0;content:"2"}mjx-c.mjx-c1D440.TEX-I::before{padding:.683em 1.051em 0 0;content:"M"}mjx-c.mjx-c39::before{padding:.666em .5em .022em 0;content:"9"}mjx-c.mjx-c2B::before{padding:.583em .778em .082em 0;content:"+"}mjx-c.mjx-c2192::before{padding:.511em 1em .011em 0;content:"→"}mjx-c.mjx-c1D443.TEX-I::before{padding:.683em .751em 0 0;content:"P"}mjx-c.mjx-c1D437.TEX-I::before{padding:.683em .828em 0 0;content:"D"}mjx-c.mjx-c1D442.TEX-I::before{padding:.704em .763em .022em 0;content:"O"}mjx-c.mjx-c1D435.TEX-I::before{padding:.683em .759em 0 0;content:"B"}mjx-c.mjx-c1D44E.TEX-I::before{padding:.441em .529em .01em 0;content:"a"}mjx-c.mjx-c1D456.TEX-I::before{padding:.661em .345em .011em 0;content:"i"}mjx-c.mjx-c5F::before{padding:0 .5em .062em 0;content:"_"}mjx-c.mjx-c1D43A.TEX-I::before{padding:.705em .786em .022em 0;content:"G"}mjx-c.mjx-c1D467.TEX-I::before{padding:.442em .465em .011em 0;content:"z"}mjx-c.mjx-c210E.TEX-I::before{padding:.694em .576em .011em 0;content:"h"}mjx-c.mjx-c1D45C.TEX-I::before{padding:.441em .485em .011em 0;content:"o"}mjx-container[jax=CHTML]{line-height:0}mjx-container [space="1"]{margin-left:.111em}mjx-container [space="2"]{margin-left:.167em}mjx-container [space="3"]{margin-left:.222em}mjx-container [space="4"]{margin-left:.278em}mjx-container [space="5"]{margin-left:.333em}mjx-container [rspace="1"]{margin-right:.111em}mjx-container [rspace="2"]{margin-right:.167em}mjx-container [rspace="3"]{margin-right:.222em}mjx-container [rspace="4"]{margin-right:.278em}mjx-container [rspace="5"]{margin-right:.333em}mjx-container [size="s"]{font-size:70.7%}mjx-container [size=ss]{font-size:50%}mjx-container [size=Tn]{font-size:60%}mjx-container [size=sm]{font-size:85%}mjx-container [size=lg]{font-size:120%}mjx-container [size=Lg]{font-size:144%}mjx-container [size=LG]{font-size:173%}mjx-container [size=hg]{font-size:207%}mjx-container [size=HG]{font-size:249%}mjx-container [width=full]{width:100%}mjx-box{display:inline-block}mjx-block{display:block}mjx-itable{display:inline-table}mjx-row{display:table-row}mjx-row>*{display:table-cell}mjx-mtext{display:inline-block}mjx-mstyle{display:inline-block}mjx-merror{display:inline-block;color:red;background-color:#ff0}mjx-mphantom{visibility:hidden}mjx-assistive-mml{top:0;left:0;clip:rect(1px,1px,1px,1px);user-select:none;position:absolute!important;padding:1px 0 0!important;border:0!important;display:block!important;width:auto!important;overflow:hidden!important}mjx-assistive-mml[display=block]{width:100%!important}mjx-math{display:inline-block;text-align:left;line-height:0;text-indent:0;font-style:normal;font-weight:400;font-size:100%;letter-spacing:normal;border-collapse:collapse;overflow-wrap:normal;word-spacing:normal;white-space:nowrap;direction:ltr;padding:1px 0}mjx-container[jax=CHTML][display=true]{display:block;text-align:center;margin:1em 0}mjx-container[jax=CHTML][display=true][width=full]{display:flex}mjx-container[jax=CHTML][display=true] mjx-math{padding:0}mjx-container[jax=CHTML][justify=left]{text-align:left}mjx-container[jax=CHTML][justify=right]{text-align:right}mjx-mi{display:inline-block;text-align:left}mjx-c{display:inline-block}mjx-utext{display:inline-block;padding:.75em 0 .2em}mjx-mo{display:inline-block;text-align:left}mjx-stretchy-h{display:inline-table;width:100%}mjx-stretchy-h>*{display:table-cell;width:0}mjx-stretchy-h>*>mjx-c{display:inline-block;transform:scaleX(1)}mjx-stretchy-h>*>mjx-c::before{display:inline-block;width:initial}mjx-stretchy-h>mjx-ext{overflow:clip visible;width:100%}mjx-stretchy-h>mjx-ext>mjx-c::before{transform:scaleX(500)}mjx-stretchy-h>mjx-ext>mjx-c{width:0}mjx-stretchy-h>mjx-beg>mjx-c{margin-right:-.1em}mjx-stretchy-h>mjx-end>mjx-c{margin-left:-.1em}mjx-stretchy-v{display:inline-block}mjx-stretchy-v>*{display:block}mjx-stretchy-v>mjx-beg{height:0}mjx-stretchy-v>mjx-end>mjx-c{display:block}mjx-stretchy-v>*>mjx-c{transform:scaleY(1);transform-origin:left center;overflow:hidden}mjx-stretchy-v>mjx-ext{display:block;height:100%;box-sizing:border-box;border:0 solid transparent;overflow:visible clip}mjx-stretchy-v>mjx-ext>mjx-c::before{width:initial;box-sizing:border-box}mjx-stretchy-v>mjx-ext>mjx-c{transform:scaleY(500) translateY(.075em);overflow:visible}mjx-mark{display:inline-block;height:0}mjx-mn{display:inline-block;text-align:left}mjx-mfrac{display:inline-block;text-align:left}mjx-frac{display:inline-block;vertical-align:.17em;padding:0 .22em}mjx-frac[type="d"]{vertical-align:.04em}mjx-frac[delims]{padding:0 .1em}mjx-frac[atop]{padding:0 .12em}mjx-frac[atop][delims]{padding:0}mjx-dtable{display:inline-table;width:100%}mjx-dtable>*{font-size:2000%}mjx-dbox{display:block;font-size:5%}mjx-num{display:block;text-align:center}mjx-den{display:block;text-align:center}mjx-mfrac[bevelled]>mjx-num{display:inline-block}mjx-mfrac[bevelled]>mjx-den{display:inline-block}mjx-den[align=right],mjx-num[align=right]{text-align:right}mjx-den[align=left],mjx-num[align=left]{text-align:left}mjx-nstrut{display:inline-block;height:.054em;width:0;vertical-align:-.054em}mjx-nstrut[type="d"]{height:.217em;vertical-align:-.217em}mjx-dstrut{display:inline-block;height:.505em;width:0}mjx-dstrut[type="d"]{height:.726em}mjx-line{display:block;box-sizing:border-box;min-height:1px;height:.06em;border-top:.06em solid;margin:.06em -.1em;overflow:hidden}mjx-line[type="d"]{margin:.18em -.1em}mjx-mrow{display:inline-block;text-align:left}mjx-c::before{display:block;width:0}.MJX-TEX{font-family:MJXZERO,MJXTEX}.TEX-B{font-family:MJXZERO,MJXTEX-B}.TEX-I{font-family:MJXZERO,MJXTEX-I}.TEX-MI{font-family:MJXZERO,MJXTEX-MI}.TEX-BI{font-family:MJXZERO,MJXTEX-BI}.TEX-S1{font-family:MJXZERO,MJXTEX-S1}.TEX-S2{font-family:MJXZERO,MJXTEX-S2}.TEX-S3{font-family:MJXZERO,MJXTEX-S3}.TEX-S4{font-family:MJXZERO,MJXTEX-S4}.TEX-A{font-family:MJXZERO,MJXTEX-A}.TEX-C{font-family:MJXZERO,MJXTEX-C}.TEX-CB{font-family:MJXZERO,MJXTEX-CB}.TEX-FR{font-family:MJXZERO,MJXTEX-FR}.TEX-FRB{font-family:MJXZERO,MJXTEX-FRB}.TEX-SS{font-family:MJXZERO,MJXTEX-SS}.TEX-SSB{font-family:MJXZERO,MJXTEX-SSB}.TEX-SSI{font-family:MJXZERO,MJXTEX-SSI}.TEX-SC{font-family:MJXZERO,MJXTEX-SC}.TEX-T{font-family:MJXZERO,MJXTEX-T}.TEX-V{font-family:MJXZERO,MJXTEX-V}.TEX-VB{font-family:MJXZERO,MJXTEX-VB}mjx-stretchy-h mjx-c,mjx-stretchy-v mjx-c{font-family:MJXZERO,MJXTEX-S1,MJXTEX-S4,MJXTEX,MJXTEX-A!important}@font-face{font-family:MJXZERO;src:url("lib/fonts/mathjax_zero.woff") format("woff")}@font-face{font-family:MJXTEX;src:url("lib/fonts/mathjax_main-regular.woff") format("woff")}@font-face{font-family:MJXTEX-B;src:url("lib/fonts/mathjax_main-bold.woff") format("woff")}@font-face{font-family:MJXTEX-I;src:url("lib/fonts/mathjax_math-italic.woff") format("woff")}@font-face{font-family:MJXTEX-MI;src:url("lib/fonts/mathjax_main-italic.woff") format("woff")}@font-face{font-family:MJXTEX-BI;src:url("lib/fonts/mathjax_math-bolditalic.woff") format("woff")}@font-face{font-family:MJXTEX-S1;src:url("lib/fonts/mathjax_size1-regular.woff") format("woff")}@font-face{font-family:MJXTEX-S2;src:url("lib/fonts/mathjax_size2-regular.woff") format("woff")}@font-face{font-family:MJXTEX-S3;src:url("lib/fonts/mathjax_size3-regular.woff") format("woff")}@font-face{font-family:MJXTEX-S4;src:url("lib/fonts/mathjax_size4-regular.woff") format("woff")}@font-face{font-family:MJXTEX-A;src:url("lib/fonts/mathjax_ams-regular.woff") format("woff")}@font-face{font-family:MJXTEX-C;src:url("lib/fonts/mathjax_calligraphic-regular.woff") format("woff")}@font-face{font-family:MJXTEX-CB;src:url("lib/fonts/mathjax_calligraphic-bold.woff") format("woff")}@font-face{font-family:MJXTEX-FR;src:url("lib/fonts/mathjax_fraktur-regular.woff") format("woff")}@font-face{font-family:MJXTEX-FRB;src:url("lib/fonts/mathjax_fraktur-bold.woff") format("woff")}@font-face{font-family:MJXTEX-SS;src:url("lib/fonts/mathjax_sansserif-regular.woff") format("woff")}@font-face{font-family:MJXTEX-SSB;src:url("lib/fonts/mathjax_sansserif-bold.woff") format("woff")}@font-face{font-family:MJXTEX-SSI;src:url("lib/fonts/mathjax_sansserif-italic.woff") format("woff")}@font-face{font-family:MJXTEX-SC;src:url("lib/fonts/mathjax_script-regular.woff") format("woff")}@font-face{font-family:MJXTEX-T;src:url("lib/fonts/mathjax_typewriter-regular.woff") format("woff")}@font-face{font-family:MJXTEX-V;src:url("lib/fonts/mathjax_vector-regular.woff") format("woff")}@font-face{font-family:MJXTEX-VB;src:url("lib/fonts/mathjax_vector-bold.woff") format("woff")}mjx-c.mjx-c1D439.TEX-I::before{padding:.68em .749em 0 0;content:"F"}mjx-c.mjx-c1D45F.TEX-I::before{padding:.442em .451em .011em 0;content:"r"}mjx-c.mjx-c1D452.TEX-I::before{padding:.442em .466em .011em 0;content:"e"}mjx-c.mjx-c1D45E.TEX-I::before{padding:.442em .46em .194em 0;content:"q"}mjx-c.mjx-c1D462.TEX-I::before{padding:.442em .572em .011em 0;content:"u"}mjx-c.mjx-c1D45B.TEX-I::before{padding:.442em .6em .011em 0;content:"n"}mjx-c.mjx-c1D450.TEX-I::before{padding:.442em .433em .011em 0;content:"c"}mjx-c.mjx-c1D466.TEX-I::before{padding:.442em .49em .205em 0;content:"y"}mjx-c.mjx-c28::before{padding:.75em .389em .25em 0;content:"("}mjx-c.mjx-c1D436.TEX-I::before{padding:.705em .76em .022em 0;content:"C"}mjx-c.mjx-c31::before{padding:.666em .5em 0 0;content:"1"}mjx-c.mjx-c29::before{padding:.75em .389em .25em 0;content:")"}mjx-c.mjx-c3D::before{padding:.583em .778em .082em 0;content:"="}</style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="背景"><p dir="auto">背景</p></h1><div class="heading-wrapper"><div class="heading-children"><div><p dir="auto">VCF 是生物信息分析中非常重要的一种格式。主要用来描述基因组突变的信息，无论是检测出来的 SNP，indel，cnv，还是 SV，都可以存储格式都为 vcf 格式。从比对生成的 bam 文件中，将潜在变异信息筛选出来，就是 vcf 格式。vcf 是一种列表格式，里面包含很多的内容。需要掌握每一列的信息，并能使用相对应的软件对 vcf 进行处理。处理 VCF 格式软件主要包括 <strong>bcftools，vcftools，gatk，python pyvcf，plink</strong> 等。</p></div></div></div><div class="heading-wrapper"><h1 data-heading="**vcf 文件格式介绍**" dir="auto" class="heading" id="**vcf_文件格式介绍**"><strong>vcf 文件格式介绍</strong></h1><div class="heading-children"><div class="heading-wrapper"><h2 data-heading="**简介**" dir="auto" class="heading" id="**简介**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>简介</strong></h2><div class="heading-children"><div><p dir="auto">VCF 是 Variant Call Format 的简称，是一种定义的专门用于存储基因序列突变信息的文本格式。在生物信息分析中会大量用到 VCF 格式。例如基因组中的单碱基突变,SNP，插入/缺失INDEL, 拷贝数变异 CNV，和结构变异 SV 等，都是利用 VCF 格式来存储的。vcf 是一种文本格式，可以直接查看。将其存储为二进制格式就是 BCF，二进制格式节省更多存储，vcf 与bcf 的关系类似 sam 与 bam 的关系。需要特别之处的是，不同软件产生的 vcf 会有很大的不同，有时候同样的操作命令在不同的 vcf 中会出错。当前 vcf 的版本为 4.3，可以参考下面的帮助文档，格式说明：</p></div><div><pre dir="auto"><code>https://samtools.github.io/hts-specs/
</code><button class="copy-code-button">复制</button></pre></div></div></div><div class="heading-wrapper"><h2 data-heading="**vcf 文件格式**" dir="auto" class="heading" id="**vcf_文件格式**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>vcf 文件格式</strong></h2><div class="heading-children"><div><p dir="auto">vcf 是一种表格格式，主要分为三部分，第一部分为双井号注释的部分，为文件头信息，主要介绍文件内容以及 INFO 部分的详细解释；</p></div><div><p dir="auto">第二部分单井号注释，为表头信息，基本内容分为 8 列，对于多样品可以继续添加列。前 8列信息分别为：</p></div><div><pre dir="auto"><code>
1.CHROM [chromosome]：染色体名称，
2.POS [position]： 参考基因组突变碱基位置，如果是 INDEL，位置是 INDEL 的第一个碱基位置。
3.ID [identifier]：突变的名称，
4.REF [reference base(s)]：参考染色体的碱基
5.ALT [alternate base(s)]：与参考序列比较，发生突变的碱基，
6.QUAL [quality]：Phred 标准下的质量值
7.FILTER [filter status]：使用其它的方法进行过滤后得到的过滤结果
8.INFO
</code><button class="copy-code-button">复制</button></pre></div><div><p dir="auto">vcf 中可以保存多个样品的信息，当文件中包含多个样品时，就会出现“FORMAT” 一列，用于提示后续不同样品中展示的信息。由于样品多，不同样品不能展示全部 INFO 的信息，通常 FORMAT 只展示少部分信息，例如“Genotype”一个信息。接下来是样品名。每个样品在后面增加一列即可，展示FORMAT 中及介绍的内容，这样就能构成一个很大的矩阵，可以用于统计检验。</p></div></div></div><div class="heading-wrapper"><h2 data-heading="**INFO 信息**" dir="auto" class="heading" id="**INFO_信息**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>INFO 信息</strong></h2><div class="heading-children"><div><p dir="auto">vcf 中的 INFO 关键字非常多，而且每个软件生成的 vcf 文件都可以单独自定义关键字。都是以 “TAG=Value”,并使用”;”分隔的形式。其中很多的 TAG 含义在 VCF 文件的头部注释信息##INFO 中已给出。这些关键字信息包含了非常多的内容，描述了每一个突变详细的信息。例如突变的类型，SNP 还是 SV，如果是 SNP 杂合还是纯合，如果是 SV，具体哪种类型，发生变化的长度是多少，有多少条 reads 支持等信息。这些信息根据不同的需求可以从中提取。在 vcf 文件格式的详细描述中会有介绍，无需掌握全部内容，只需要了解一些常见的关键信息即可。</p></div><div><p dir="auto">下面介绍一些常见关键字内容，更多内容可以查看表头信息，或者查看 vcf 详细文档。</p></div><div><p dir="auto">GT：GT 为基因型（genotype）的简写，是 vcf 中非常重要的关键字。在做变异检测之后通常还要做一步 genotype 就是为了得到这个信息。两个数字中间用’/"分开，这两个数字表示双倍体的 sample 的基因型，</p></div><div><p dir="auto">0 表示样品的基因型与 ref 的 allele 相同；</p></div><div><p dir="auto">1 表示样品中基因型与 alt variant 的相同；</p></div><div><p dir="auto">2 表示有第二个 variant 的 allele（和 ALT 的第二种碱基相同）</p></div><div><p dir="auto">所以，我们就可以根据 GT 关键字判断出样品的基因型。假设这个突变中 REF 为 A 碱基， ALT 为 T 碱基。如果 GT 为：</p></div><div><pre dir="auto"><code>
0/0 ：表示 sample 中该位点为纯合位点，和 REF 的碱基类型一致，那么就是 AA。
0/1：表示 sample 中该位点为杂合突变，有 REF 和 ALT 两个基因型，那么就是 AT；如果是 GT 是
1/0，则表示 TA。
1/1：表示 sample 中该位点为纯合突变，总体突变类型和 ALT 碱基类型一致，为 TT。
1/2：表示 sample 中该位点为杂合突变，有 ALT1 和 ALT2 两个基因型，可能是 TC 或者 TG。
</code><button class="copy-code-button">复制</button></pre></div><div><p dir="auto">AD：Allele Depth：为 sample 中每一种 allele（等位碱基）的 reads 覆盖度，在 diploid（二倍体，或可指代多倍型）中则是用逗号分隔的两个值，前者对应 REF 基因，后者对应 ALT基因型；</p></div><div><p dir="auto">DP：Depth：为 sample 中该位点的覆盖度，是所支持的两个 AD 值（逗号前和逗号后）的加和，支持数越高，结果越可信，通常可以用于 DP 进行突变结果过滤，例如将小于 5 条 reads支持的过滤掉。</p></div><div><p dir="auto">GQ：基因型的质量值(Genotype Quality)。Phred 格式(Phred_scaled)的质量值，表示在该位点该基因型存在的可能性；该值越高，则 Genotype 的可能性越 大；计算方法：Phred 值 = -10 * log (1-p) p 为基因型存在的概率。和 DP 类似，也可以用于突变结果过滤。</p></div><div><p dir="auto">PL：指定的三种基因型的质量值(provieds the likelihoods of the given genotypes)。这三种指定的基因型为(0/0,0/1,1/1)，这三种基因型的概率总和为 1。和之前不一致，该值越大，表明为该种基因型的可能性越小。Phred 值 = -10 * log (p) p 为基因型存在的概率。</p></div><div><p dir="auto">AC：（Allele Count）：Alt Allele 的数目（即当前位点等位基因数量）。</p></div><div><p dir="auto">AN：（Allele Number）：表示 alt Allele 的总数目。</p></div><div><p dir="auto">AF：（Allele Frequency）：表示 alt Allele 的频率，AF 值=AC 值/AN 值。</p></div><div><p dir="auto">FS：FS 是一个通过 Fisher 检验的 p-value 转换而来的值，它要描述的是测序或者比对时对于只含有变异的 read 以及只含有参考序列碱基的 read 是否存在着明显的正负链特异性（Strand bias，或者说是差异性）。这个差异反映了测序过程不够随机，或者是比对算法在基因组的某些区域存在一定的选择偏向。如果测序过程是随机的，比对是没问题的，那么不管 read 是否含有变异，以及是否来自基因组的正链或者负链，只要是真实的它们就都应该是比较均匀的，也就是说，不会出现链特异的比对结果，FS 应该接近于零。</p></div><div><p dir="auto">MLEAC：AC（Allele counts）的极大似然期望值。</p></div><div><p dir="auto">MLEAF：AF（Allele Frequency）的极大似然期望值。</p></div><div><p dir="auto">MQ：（Mapping quality）：比对质量值。</p></div></div></div><div class="heading-wrapper"><h2 data-heading="**vcf 文件中如何描述 SV**" dir="auto" class="heading" id="**vcf_文件中如何描述_SV**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>vcf 文件中如何描述 SV</strong></h2><div class="heading-children"><div><p dir="auto">在 vcf 文件中，SV 通常可以通过 SVTYPE 关键字进行描述，然后用 SVLEN 关键字描述具体发生 SV 的长度。由于 SV 包含多种类型，SVTYPE 关键字也可以分成以下几种：</p></div><div><pre dir="auto"><code>DEL ：缺失，Deletion relative to the reference
INS： 插入，Insertion of novel sequence relative to the reference
DUP ：倍增，Region of elevated copy number relative to the reference
INV ：翻转，Inversion of reference sequence
CNV ：拷贝数变异，Copy number variable region (may be both deletion and duplication)
BND ：断开，Breakend
</code><button class="copy-code-button">复制</button></pre></div><div><p dir="auto">CNV 拷贝数变化属于插入和缺失范畴，有些软件没有被单独列为一个类目，被包含在倍增DUP，缺失 DEL 以及插入 INS 中。</p></div></div></div><div class="heading-wrapper"><h2 data-heading="**注意事项**" dir="auto" class="heading" id="**注意事项**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>注意事项</strong></h2><div class="heading-children"><div><ol dir="auto">
<li data-line="0" dir="auto">不同版本的 vcf 格式文件有所差别，在使用过程中需要注意 vcf 的版本；</li>
<li data-line="1" dir="auto">不同软件生成的 vcf 有很大的差别，尤其是对于 SV 的描述方法，例如 gatk，freebayes，sniffles 等，有很大的不同。</li>
<li data-line="2" dir="auto">不同软件生成的 vcf 文件，INFO 部分会有很大的不同，在使用过程中要根据具体的内容修改代码。</li>
</ol></div></div></div></div></div><div class="heading-wrapper"><h1 data-heading="软件操作" dir="auto" class="heading" id="软件操作">软件操作</h1><div class="heading-children"><div class="heading-wrapper"><h2 data-heading="**利用 bcftools 处理 vcf 文件**" dir="auto" class="heading" id="**利用_bcftools_处理_vcf_文件**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>利用 bcftools 处理 vcf 文件</strong></h2><div class="heading-children"><div><p dir="auto">处理 VCF 格式软件：bcftools，vcftools，gatk，python pyvcf，plink 等。最常用的为 bcftools。这里我们分别介绍 bcftools 与 vcftools。bcfools 可以直接处理 vcf 文件，也可以处理二进制bcf 文件。<br>
<img alt="image.png" src="https://picturerealm.oss-cn-chengdu.aliyuncs.com/obsidian/202401230846638.png" referrerpolicy="no-referrer" style="width: 500px; max-width: 100%;"><br>
<a data-tooltip-position="top" aria-label="http://www.htslib.org/doc/bcftools.html" rel="noopener" class="external-link" href="http://www.htslib.org/doc/bcftools.html" target="_blank">软件说明文档点这里</a><br>
bcftools 是专门用来处理 vcf 以及 bcf 文件格式的工具，使用起来类似于 samtools。软件的安装和使用非常简单。</p></div><div><pre dir="auto"><code>  # 安装
  conda install -y bcftools
</code><button class="copy-code-button">复制</button></pre></div><div class="heading-wrapper"><h3 data-heading="**软件介绍**" dir="auto" class="heading" id="**软件介绍**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>软件介绍</strong></h3><div class="heading-children"><div><p dir="auto">主要分为三大功能类。</p></div><div><ol dir="auto">
<li data-line="0" dir="auto">Indexing 建立<mark>索引</mark>；</li>
<li data-line="1" dir="auto">VCF/BCF manipulation ：vcf 和 bcf 文件<mark>操作</mark>；</li>
<li data-line="2" dir="auto">VCF/BCF analysis ：vcf 和 bcf 文件<mark>分析</mark>；</li>
</ol></div><div class="heading-wrapper"><h4 data-heading="indexing" dir="auto" class="heading" id="indexing"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>indexing</h4><div class="heading-children"><div><pre dir="auto"><code>  index，就是为文件建立索引；
</code><button class="copy-code-button">复制</button></pre></div></div></div><div class="heading-wrapper"><h4 data-heading="manipulation" dir="auto" class="heading" id="manipulation"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>manipulation</h4><div class="heading-children"><div><pre dir="auto"><code>annotate 注释，用于增加或者移除注释信息；
concat 连接同一个样品或者同一个数据集的 vcf 或者 bcf 文件；
convert 格式转换 VCF 与 BCF 之间转换，或者转换为其他格式；
isec 取交集，多个 vcf 文件文件可以取共有的突变；
merge 和 samtools 的 merge 类似，合并文件，
norm normalize 标准化 indels
plugin 用户自定义功能
query 将 vcf 或 bcf 转换为用户自定义格式；
reheader 修改 header 文件，修改样品名等；
sort 对文件排序；
view 查看文件
</code><button class="copy-code-button">复制</button></pre></div></div></div><div class="heading-wrapper"><h4 data-heading="analysis" dir="auto" class="heading" id="analysis"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>analysis</h4><div class="heading-children"><div><pre dir="auto"><code>call Call SNP 和 Indel；
consensus 将所有变异位点合并成一个一致性序列
cnv Copy Number Variation caller，检测拷贝数变异
csq 检测变异的一致性序列；
filter 过滤 vcf
gtcheck 检查样本一致性，检测样品交换和污染
mpileup 和 samtools 的 mpileup 类似；
roh 识别 autozygosity
stats 进行统计
</code><button class="copy-code-button">复制</button></pre></div></div></div><div class="heading-wrapper"><h4 data-heading="常用选项参数" dir="auto" class="heading" id="常用选项参数"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>常用选项参数</h4><div class="heading-children"><div><pre dir="auto"><code>output options:
--no-version 
-o, --output &lt;XXX&gt; ：输出文件名，最好与文件类型保持一致，例如 vcf，vcf.gz，bcf，
bcf.gz 
-O, --output-type &lt;b|u|z|v&gt;：输出文件类型，b,u,z,v 分别对应 bcf 与 vcf，以及是否压缩
 --threads &lt;int&gt; ：线程数
-e, --exclude &lt;expr&gt; ：排除
-i, --include &lt;expr&gt; ：包括
-r, --regions &lt;region&gt; ：区域，给定表达式，染色体：起始位置-终止位置
-R, --regions-XXX &lt;XXX&gt; ：区域，bed 文件
-s, --samples &lt;list&gt; ：样品名，多个样品之间用逗号分隔
-S, --samples-XXX &lt;XXX&gt; ：样品名文件
-t, --targets &lt;region&gt; ：目标，染色体名字，例如 chr1，多个染色体之间用逗号分隔
-T, --targets-XXX &lt;XXX&gt; ：目标，写到文件中
-l, --compression-level [0-9] ：压缩等级，数字越大，压缩率越高，压缩时间越长

</code><button class="copy-code-button">复制</button></pre></div></div></div><div class="heading-wrapper"><h4 data-heading="表达式" dir="auto" class="heading" id="表达式"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>表达式</h4><div class="heading-children"><div><p dir="auto"><a data-tooltip-position="top" aria-label="http://www.htslib.org/doc/bcftools.html#expressions" rel="noopener" class="external-link" href="http://www.htslib.org/doc/bcftools.html#expressions" target="_blank">参见这个网址</a></p></div></div></div></div></div><div class="heading-wrapper"><h3 data-heading="使用案例" dir="auto" class="heading" id="使用案例"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>使用案例</h3><div class="heading-children"><div><p dir="auto">我将用一个真实的案例进行说明。</p></div><div><ol dir="auto">
<li data-line="0" dir="auto">格式转换<br>
格式转换是将 vcf 与 bcf 之间进行格式转换，并同时进行压缩，bcf 为二进制格式，无法使用 less 等命令直接查看，但更加节约存储。如果是 bcf 格式文件，可以使用 view 功能进行查看。vcf 或者 bcf 必须使用 bgzip 压缩。假如你的vcf文件名称是<code>xxx</code>。</li>
</ol></div><div><p dir="auto">&nbsp;</p></div><div><pre dir="auto"><code>#格式转换压缩
bcftools view  XXX.vcf -O b -o XXX.bcf.gz

# 我发现这个命令也挺好用，和上面那个差不多
bgzip -c XXX.vcf &gt; XXX.vcf.gz
</code><button class="copy-code-button">复制</button></pre></div><div><ol start="2" dir="auto">
<li data-line="0" dir="auto">建立索引<br>
对于行数较多的数据，需要建立索引。这样便于快速检索。索引需要基于排序后的结果。后面很多应用都需要使用到索引。排序可以使用 sort 功能，索引使用 index 功能。<strong>index 命令用于对 VCF 文件建立索引，要求输入的 VCF 文件必须是使用 bgzip 压缩之后的文件，支持.csi和.tbi 两种索引</strong>，默认情况下建立的索引是.csi 格式。</li>
</ol></div><div><pre dir="auto"><code>
#排序
bcftools sort XXX.bcf.gz
# （一般来说应该已经排序好了，如果是这样，就可以跳过这一步）
# 如何查看有没有排好？使用 less -S命令。

#建立索引
bcftools index XXX.bcf.gz
</code><button class="copy-code-button">复制</button></pre></div><div><p dir="auto">容我BB两句，如果我们只想对某条染色体进行分析（例如X、Y或者mtDNA），那么我们需要<mark>先把单独的染色体提取出来，不然分析将会很慢</mark>。那样的话请先看第下文中如何<strong>6.提取某一条染色体</strong>。<br>
3. 统计绘图<br>
如果想知道 vcf 中包含多少种突变，以及每种突变对应的数据，就需要对文件进行统计，stats选项可以用于 vcf 文件的统计。可以直接统计突变个数、突变类型的个数、转换颠换个数、测序深度、Indel 长度。统计完成之后可以使用 plot-vcfstats 进行可视化绘图。</p></div><div><pre dir="auto"><code># 数据统计与绘图
bcftools stats XXX.bcf.gz &gt;view.stats
plot-vcfstats view.stats -p output
</code><button class="copy-code-button">复制</button></pre></div><div><ol start="4" dir="auto">
<li data-line="0" dir="auto">查看固定区域<br>
建立索引之后，就可以快速检索目标区域，例如得到结果之后，想快速查看某一区域，或者某个基因的情况，可以直接填写目标区域，格式为“染色体：起始位点-终止位点”。如果一次要查看多个区域，则可以添加一个 bed 文件。</li>
</ol></div><div><pre dir="auto"><code>#查看固定区域
bcftools view XXX.bcf.gz
bcftools view all.bcf.gz 12:200000-300000
#选出位于 bed 文件中的所有区域的突变位点
bcftools view -R Target.bed XXX.bcf.gz &gt;filt.onTarget.vcf
</code><button class="copy-code-button">复制</button></pre></div><div><ol start="5" dir="auto">
<li data-line="0" dir="auto">拆分不同类型</li>
</ol></div><div><pre dir="auto"><code>#提取 SNP
bcftools view -v snps chr22.vcf &gt;chr22.snp.vcf
#提取 InDel
bcftools view -v indels chr22.vcf &gt;chr22.indel.vcf
#提取 SV
bcftools view -v other chr22.vcf &gt;chr22.sv.vcf
</code><button class="copy-code-button">复制</button></pre></div><div><ol start="6" dir="auto">
<li data-line="0" dir="auto">提取某一条染色体</li>
</ol></div><div><pre dir="auto"><code>#提取 26号染色体
bcftools view -r 26 XXX.vcf.gz &gt; Chromosome_26_variants.vcf
</code><button class="copy-code-button">复制</button></pre></div><div><ol start="7" dir="auto">
<li data-line="0" dir="auto">concat 合并</li>
</ol></div><div><pre dir="auto"><code>#合并 21 和 22 号染色体的结果
bcftools concat chr21.vcf chr22.vcf -o merge.bcf.gz -O b
#合并 SNP 与 InDel
bcftools concat chr22.snp.vcf chr22.indel.vcf -o chr22.merge.vcf
</code><button class="copy-code-button">复制</button></pre></div><div><ol start="8" dir="auto">
<li data-line="0" dir="auto">提取固定样品</li>
</ol></div><div><pre dir="auto"><code>#筛选样品 HG00100
bcftools view -s HG00100
ALL.chr1.phase3_shapeit2_mvncall_integrated_v5a.20130502.genotypes.vcf.gz -O
b &gt;HG00100.vcf
#筛选样品 HG00141
bcftools view -s HG00141
ALL.chr1.phase3_shapeit2_mvncall_integrated_v5a.20130502.genotypes.vcf.gz -O
b &gt;HG00141.vcf
</code><button class="copy-code-button">复制</button></pre></div><div><ol start="9" dir="auto">
<li data-line="0" dir="auto">merge 合并<br>
vcf 中不仅可以包含单个样品，也可以同时包含多个样品的信息，只需要将多个样品的 vcf合并即可。可以使用 merge 功能进行合并，与 concat“横向合并”不同，merge 合并为“纵向合并”，是合并不同样品到同一个 vcf 文件中。注意合并之前需要对每个样品创建索引。</li>
</ol></div><div><pre dir="auto"><code># 合并样品 HG00100 与 HG00141
bcftools merge a.vcf.gz b.vcf.gz -o merge.vcf
</code><button class="copy-code-button">复制</button></pre></div><div><p dir="auto"><mark>注意：输入文件必须是经过 bgzip 压缩的文件， 而且还需要有.tbi 的索引</mark>。</p></div><div><ol start="10" dir="auto">
<li data-line="0" dir="auto">集合运算<br>
isec 用于在多个 VCF 文件之间取交集，差集，并集等操作，经典的应用场景是对多种软件的SNP calling 结果进行 venn 分析。用法如下</li>
</ol></div><div><pre dir="auto"><code>&nbsp;isec 用于在多个 VCF 文件之间取交集，差集，并集等操作，经典的应用场景是对多种软件的SNP calling 结果进行 venn 分析。用法如下
</code><button class="copy-code-button">复制</button></pre></div><div><div data-callout-metadata="" data-callout-fold="" data-callout="warning" class="callout" dir="auto"><div class="callout-title" dir="auto"><div class="callout-icon" dir="auto"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-alert-triangle"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner" dir="auto">默认参数就是取交集，更多高级用法请参考帮助文档</div></div><div class="callout-content" dir="auto">
<ol start="11" dir="auto">
<li data-line="2" dir="auto">query 功能<br>
vcf 里面包含的信息非常多，比较混乱，如果只想从中筛选出需要的内容，例如只需要Genotype 信息，可以使用 bcftools 的 query 功能实现。query 中最重要的就是表达式的写法。</li>
</ol>
</div></div></div><div><pre dir="auto"><code>bcftools query -f '%CHROM\t%POS\t%REF\t%ALT[\t%SAMPLE=%GT]\n' A1.bcf.gz
</code><button class="copy-code-button">复制</button></pre></div><div><p dir="auto">注意格式的熟悉，每个关键字前面使用%，“\t”或者“\n”代表制表符与换行符。</p></div><div><ol start="12" dir="auto">
<li data-line="0" dir="auto">过滤<br>
变异检测的策略一般是先找全，然后再找准。也就是软件首先输出尽可能多的结果，保存到vcf 文件中，然后再采取不同的标准对 vcf 进行过滤。过滤可以采取很多的标准，一般包括测序深度，打分制，碱基质量值，先验概率等。可以使用 bcftools 进行过滤。bcftools 的 filter功能其实与 query，view 都类似，可以进行多种模式的过滤，<mark>关键是要掌握其表达式EXPRESSIONS 的写法。</mark></li>
</ol></div><div><pre dir="auto"><code>#过滤掉等位频率&gt;0.3 同时覆盖深度小于 10 的突变位点
bcftools filter -e "INFO/AF[0] &gt; 0.3 &amp; FORMAT/DP &lt; 30" A1.bcf.gz
bcftools view -i '%TYPE!="snp" &amp; MAF[0]&lt;0.01'
ALL.chr1.phase3_shapeit2_mvncall_integrated_v5a.20130502.genotypes.vcf.g
</code><button class="copy-code-button">复制</button></pre></div><div><ol start="13" dir="auto">
<li data-line="0" dir="auto">注释<br>
vcf 的注释主要是将突变位点定位到基因组上，确定突变发生在哪个基因，因为不同的突变发生位置，会对基因产生不同的影响，例如<mark>同义突变，错误突变或者无义突变等</mark>。另外一种注释就是与已知突变位点进行比较，定位到已知的 rs number 号上面。</li>
</ol></div><div><pre dir="auto"><code>#注释 VCF 文件，用法如下
bcftools annotate -a /ifs1/Database/gatk/hg38/dbsnp_146.hg38.vcf.gz -c ID,QUAL
,+TAG XXX.vcf -o annotate.vcf
</code><button class="copy-code-button">复制</button></pre></div><div><p dir="auto"><code>-a</code> 参数指定注释用的数据库文件，格式可以是 VCF, BED, 或者是\t 分隔的自定义文件。在\t 分隔的自定义文件中，必须包含 CHROM, POS 字段；<br>
<code>-c</code> 参数指定将数据库的哪些信息添加到输出文件中。</p></div><div><pre dir="auto"><code>#编辑 VCF 文件，比如去除其中的某些注释信息，或者去除某些样本
bcftools annotate -x ID,INFO/DP,FORMAT/DP view.vcf -o removed.id.vcf
</code><button class="copy-code-button">复制</button></pre></div><div><p dir="auto"><code>-x</code> 参数表示去除 VCF 文件中的注释信息，可以是其中的某一列，比如 ID, 也可以是某些字段，比如 INFO/DP，多个字段的信息用逗号分隔；去除之后，这些信息所在的列并不会去除，而是用.填充。</p></div><div class="mod-footer"></div></div></div></div></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="linux和bash脚本\vcf文件初识.html#背景"><div class="tree-item-contents heading-link" heading-name="背景"><span class="tree-item-title">背景</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="linux和bash脚本\vcf文件初识.html#**vcf_文件格式介绍**"><div class="tree-item-contents heading-link" heading-name="**vcf 文件格式介绍**"><span class="tree-item-title"><strong>vcf 文件格式介绍</strong></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="2"><a class="tree-link" href="linux和bash脚本\vcf文件初识.html#**简介**"><div class="tree-item-contents heading-link" heading-name="**简介**"><span class="tree-item-title"><strong>简介</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="linux和bash脚本\vcf文件初识.html#**vcf_文件格式**"><div class="tree-item-contents heading-link" heading-name="**vcf 文件格式**"><span class="tree-item-title"><strong>vcf 文件格式</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="linux和bash脚本\vcf文件初识.html#**INFO_信息**"><div class="tree-item-contents heading-link" heading-name="**INFO 信息**"><span class="tree-item-title"><strong>INFO 信息</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="linux和bash脚本\vcf文件初识.html#**vcf_文件中如何描述_SV**"><div class="tree-item-contents heading-link" heading-name="**vcf 文件中如何描述 SV**"><span class="tree-item-title"><strong>vcf 文件中如何描述 SV</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="linux和bash脚本\vcf文件初识.html#**注意事项**"><div class="tree-item-contents heading-link" heading-name="**注意事项**"><span class="tree-item-title"><strong>注意事项</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="linux和bash脚本\vcf文件初识.html#软件操作"><div class="tree-item-contents heading-link" heading-name="软件操作"><span class="tree-item-title">软件操作</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="linux和bash脚本\vcf文件初识.html#**利用_bcftools_处理_vcf_文件**"><div class="tree-item-contents heading-link" heading-name="**利用 bcftools 处理 vcf 文件**"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><strong>利用 bcftools 处理 vcf 文件</strong></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-link" href="linux和bash脚本\vcf文件初识.html#**软件介绍**"><div class="tree-item-contents heading-link" heading-name="**软件介绍**"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><strong>软件介绍</strong></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="4"><a class="tree-link" href="linux和bash脚本\vcf文件初识.html#indexing"><div class="tree-item-contents heading-link" heading-name="indexing"><span class="tree-item-title">indexing</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="linux和bash脚本\vcf文件初识.html#manipulation"><div class="tree-item-contents heading-link" heading-name="manipulation"><span class="tree-item-title">manipulation</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="linux和bash脚本\vcf文件初识.html#analysis"><div class="tree-item-contents heading-link" heading-name="analysis"><span class="tree-item-title">analysis</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="linux和bash脚本\vcf文件初识.html#常用选项参数"><div class="tree-item-contents heading-link" heading-name="常用选项参数"><span class="tree-item-title">常用选项参数</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="linux和bash脚本\vcf文件初识.html#表达式"><div class="tree-item-contents heading-link" heading-name="表达式"><span class="tree-item-title">表达式</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="linux和bash脚本\vcf文件初识.html#使用案例"><div class="tree-item-contents heading-link" heading-name="使用案例"><span class="tree-item-title">使用案例</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>