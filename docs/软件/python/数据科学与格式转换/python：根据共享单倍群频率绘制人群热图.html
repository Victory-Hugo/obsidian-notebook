<!DOCTYPE html> <html><head>
		<title>pythonï¼šæ ¹æ®å…±äº«å•å€ç¾¤é¢‘ç‡ç»˜åˆ¶äººç¾¤çƒ­å›¾</title>
		<base href="..\..\../">
		<meta id="root-path" root-path="..\..\../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="æ€ç»´é¢†åŸŸ - pythonï¼šæ ¹æ®å…±äº«å•å€ç¾¤é¢‘ç‡ç»˜åˆ¶äººç¾¤çƒ­å›¾">
		<meta property="og:title" content="pythonï¼šæ ¹æ®å…±äº«å•å€ç¾¤é¢‘ç‡ç»˜åˆ¶äººç¾¤çƒ­å›¾">
		<meta property="og:description" content="æ€ç»´é¢†åŸŸ - pythonï¼šæ ¹æ®å…±äº«å•å€ç¾¤é¢‘ç‡ç»˜åˆ¶äººç¾¤çƒ­å›¾">
		<meta property="og:type" content="website">
		<meta property="og:url" content="è½¯ä»¶/python/æ•°æ®ç§‘å­¦ä¸æ ¼å¼è½¬æ¢/pythonï¼šæ ¹æ®å…±äº«å•å€ç¾¤é¢‘ç‡ç»˜åˆ¶äººç¾¤çƒ­å›¾.html">
		<meta property="og:image" content="https://picturerealm.oss-cn-chengdu.aliyuncs.com/obsidian/202403262141478.png">
		<meta property="og:site_name" content="æ€ç»´é¢†åŸŸ">
		<meta name="author" content="Victory_Hugo"><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.4.0/pixi.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="https://cdn.jsdelivr.net/npm/minisearch@6.3.0/dist/umd/index.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="stylesheet" href="lib/styles/theme.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/supported-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/supported-plugins.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript></head><body class="publish css-settings-manager theme-dark show-inline-title show-ribbon trim-cols h1-l h2-l h3-l h4-l h5-l h6-l image-blend-light active-line-on checkbox-square hide-help styled-scrollbars fast-animations"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><pre class="frontmatter language-yaml" style="display: none;" tabindex="0"><code class="language-yaml is-loaded"><span class="token key atrule">icon</span><span class="token punctuation">:</span> ğŸ‘</code><button class="copy-code-button">å¤åˆ¶</button></pre><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="åŸç†"><div id="webpage-icon"><p dir="auto"><span><img class="emoji" draggable="false" alt="ğŸ‘" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/1f44d.svg" width="18px" height="18px"></span></p></div><p dir="auto">åŸç†</p></h1><div><p dir="auto">æ–‡çŒ®å‡ºå¤„æ˜¯ <a data-href="æ—©æœŸå—å²›äººï¼šè¿›å‡ºå°æ¹¾" href="æ–‡çŒ®åŠæŠ¥é“/æ–‡çŒ®/æ—©æœŸå—å²›äººï¼šè¿›å‡ºå°æ¹¾.html" class="internal-link" target="_self" rel="noopener">æ—©æœŸå—å²›äººï¼šè¿›å‡ºå°æ¹¾</a>ã€‚å¯ä»¥æ ¹æ®å•å€ç¾¤é¢‘ç‡åˆ†å¸ƒæ¥è®¡ç®—ä¸åŒç¾¤ä½“ä¹‹é—´çš„äº²ç¼˜å…³ç³»ï¼Œç±»ä¼¼äº <a data-href="ç§ç¾¤é…å¯¹Fstå€¼ï¼ˆPopulation pairwise Fst valuesï¼‰" href="æœ¯è¯­/ç§ç¾¤é…å¯¹fstå€¼ï¼ˆpopulation-pairwise-fst-valuesï¼‰.html" class="internal-link" target="_self" rel="noopener">ç§ç¾¤é…å¯¹Fstå€¼ï¼ˆPopulation pairwise Fst valuesï¼‰</a>ã€‚</p></div><div class="heading-wrapper"><div class="heading-children"><div><p dir="auto">æˆ‘ä»¬é€šè¿‡è¯†åˆ«å…±æœ‰å•å€ç¾¤çš„æ–¹æ³•æ¥æ¯”è¾ƒä¸åŒäººç¾¤çš„é—ä¼ å…³ç³»ã€‚æˆ‘ä»¬é€šè¿‡æˆå¯¹çŸ©é˜µçš„æ–¹å¼ï¼ŒæŠŠæˆå¯¹äººç¾¤å…±äº«å•å€ç¾¤çš„æœ€å°é¢‘ç‡æ•°å€¼è§†ä¸ºè¯¥ä¸¤ä¸ªäººç¾¤çš„å…±äº«å•å€ç¾¤å€¼ã€‚è€Œè¿™ä¸¤ä¸ªäººç¾¤éå…±äº«å•å€ç¾¤çš„å€¼ï¼Œå³æŸä¸€å•å€ç¾¤åœ¨æˆå¯¹æ¯”è¾ƒä¸­è¯¥äººç¾¤æœ‰ä½†æ˜¯å¦ä¸ªä¸€äººç¾¤æ²¡æœ‰çš„å•å€ç¾¤ï¼Œè§†ä¸ºç‹¬æœ‰å•å€ç¾¤é¢‘ç‡ã€‚æ¯ä¸ªäººç¾¤å…±äº«ã€éå…±äº«å•å€ç¾¤çš„å€¼éƒ½é™¤ä»¥æ€»è®¡æ•°ï¼Œä»è€Œå½’ä¸€åŒ–æ•°æ®ã€‚æ®æ­¤å¾—åˆ°çš„å…±äº«å•å€ç¾¤æ•°å€¼æ¥è¡¡é‡äººç¾¤ä¹‹é—´çš„åŸºå› ç›¸ä¼¼æ€§çš„ç¨‹åº¦ã€‚</p></div></div></div><div class="heading-wrapper"><h1 data-heading="æ•°æ®å‡†å¤‡" dir="auto" class="heading" id="æ•°æ®å‡†å¤‡">æ•°æ®å‡†å¤‡</h1><div class="heading-children"><div><p dir="auto">ä»¥ <code>csv</code> æ–‡ä»¶å‡†å¤‡æ¯ä¸ª <code>ç¾¤ä½“</code> ä¸­çš„å•å€å‹çš„åˆ†å¸ƒé¢‘ç‡ã€‚</p></div><div><pre class="language-txt" tabindex="0"><code class="language-txt is-loaded">,Ami,Atayal,Bunun,Paiwan,Puyuma,Rukai,Saisiat,Tsou
A5b1,10,4,2,2,2.6,4,4.2,8.3
B4a1a,0,0,0,8,0.0,0,0.0,0.0
B4a1a3,12,0,0,24,0.0,4,0.0,0.0
B4a2a,0,0,0,0,0.0,0,0.0,0.0
B4b1a2,8,2,34,8,0.0,8,16.7,10.4
B5a2a,2,0,12,0,0.0,0,0.0,2.1
C7a,0,0,0,4,0.0,0,0.0,0.0
D4a,0,0,0,0,0.0,0,0.0,2.1
D4i,8,2,2,12,2.6,2,12.5,4.2
D5a2,0,0,0,0,0.0,0,0.0,0.0
D5b,0,0,0,0,0.0,48,0.0,0.0
D5b1c1,0,4,0,0,2.6,0,0.0,0.0
D6a2,10,0,4,0,5.1,0,0.0,0.0
E1a,0,2,0,0,0.0,0,0.0,0.0
E1a1,4,6,0,0,0.0,0,0.0,0.0
E1a1a,0,0,0,0,0.0,0,0.0,0.0
E1a1a2,2,8,2,2,20.5,2,4.2,2.1
E2b1,0,0,0,0,0,0,0.0,0.0
F1a1d,0,0,4,2,7.7,0,0.0,8.3
F1a3,0,0,4,0,17.9,2,0.0,8.3
F1a3a,0,0,0,0,0.0,0,0.0,0.0
F1a4a1,2,22,2,2,28.2,20,12.5,10.4
F2,2,0,8,0,0.0,0,0.0,4.2
F3b1,0,0,0,12,0.0,0,0.0,0.0
F4b,2,0,18,0,0.0,0,0.0,2.1
M7b3a,4,40,4,10,2.6,6,37.5,10.4
M7c'e'f,0,0,0,0,0.0,0,0.0,0.0
M7c1,8,0,0,0,0.0,0,0.0,0.0
M7c3a,0,0,0,0,0.0,0,0.0,0.0
M7c3b,2,6,2,2,7.7,0,8.3,4.2
M7c3c,0,0,0,12,0.0,0,0.0,0.0
M8a2,2,0,0,0,0.0,0,0.0,0.0
R9c1a,0,4,2,0,2.6,4,4.2,22.9
</code><button class="copy-code-button">å¤åˆ¶</button></pre></div></div></div><div class="heading-wrapper"><h1 data-heading="ä»£ç å®ç°" dir="auto" class="heading" id="ä»£ç å®ç°">ä»£ç å®ç°</h1><div class="heading-children"><div><pre class="language-python" tabindex="0"><code class="language-python is-loaded"><span class="token comment"># å¯¼å…¥æ‰€éœ€çš„åº“</span>
<span class="token comment"># å¯¼å…¥æ‰€éœ€çš„åº“</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token comment"># è½½å…¥æ•°æ®ï¼Œæ•°æ®ä¸ºCSVæ ¼å¼ï¼Œç¼–ç ä¸ºUTF-8</span>
file_path <span class="token operator">=</span> <span class="token string">'äººç¾¤å•å€ç¾¤é¢‘ç‡åˆ†å¸ƒ.csv'</span> <span class="token comment"># æ•°æ®æ–‡ä»¶è·¯å¾„</span>
save_path <span class="token operator">=</span> <span class="token string">'é¢‘ç‡è¡¨å½’ä¸€åŒ–.csv'</span> <span class="token comment"># ä¿å­˜æ–‡ä»¶è·¯å¾„</span>
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> 

<span class="token comment"># å°†å•å€ç¾¤åˆ—è®¾ç½®ä¸ºDataFrameçš„ç´¢å¼•</span>
data<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">'Unnamed: 0'</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># åœ¨è¿™é‡Œè¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼Œä½¿å¾—æ¯ä¸€åˆ—çš„æ€»å’Œä¸æ˜¯1è€Œæ˜¯100</span>
data <span class="token operator">=</span> data <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">/</span> data<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># å®šä¹‰è®¡ç®—å…±äº«å•å€ç¾¤çŸ©é˜µçš„å‡½æ•°</span>
<span class="token keyword">def</span> <span class="token function">calculate_shared_haplogroups_matrix</span><span class="token punctuation">(</span>haplogroups_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># è·å–äººç¾¤æ•°é‡</span>
    n_populations <span class="token operator">=</span> haplogroups_data<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token comment"># åˆå§‹åŒ–å…±äº«å•å€ç¾¤çŸ©é˜µï¼Œåˆå§‹å€¼ä¸º0</span>
    shared_haplogroups_matrix <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>n_populations<span class="token punctuation">,</span> n_populations<span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token comment"># è·å–äººç¾¤åç§°åˆ—è¡¨</span>
    populations <span class="token operator">=</span> haplogroups_data<span class="token punctuation">.</span>columns
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_populations<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> n_populations<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># è®¡ç®—ä¸¤ä¸ªäººç¾¤ä¹‹é—´å…±äº«å•å€ç¾¤çš„æœ€å°é¢‘ç‡å€¼</span>
            shared_haplogroups <span class="token operator">=</span> np<span class="token punctuation">.</span>minimum<span class="token punctuation">(</span>haplogroups_data<span class="token punctuation">[</span>populations<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> haplogroups_data<span class="token punctuation">[</span>populations<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token comment"># æ³¨æ„è¿™é‡Œæˆ‘ä»¬ä¸éœ€è¦å†æ¬¡å½’ä¸€åŒ–shared_haplogroupsçš„å€¼ï¼Œå› ä¸ºå®ƒå·²ç»æ ¹æ®å‰é¢çš„è¦æ±‚è¿›è¡Œäº†è°ƒæ•´</span>
            shared_value <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>shared_haplogroups<span class="token punctuation">)</span>
            shared_haplogroups_matrix<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> shared_value
            shared_haplogroups_matrix<span class="token punctuation">[</span>j<span class="token punctuation">,</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> shared_value
    
    <span class="token comment"># å°†å¯¹è§’çº¿çš„å€¼è®¾ç½®ä¸º100ï¼Œå› ä¸ºæ¯ä¸ªäººç¾¤ä¸è‡ªå·±çš„å…±äº«å•å€ç¾¤å€¼æ˜¯æœ€å¤§çš„ï¼Œå¹¶ä¸”æˆ‘ä»¬æƒ³è®©å®ƒåæ˜ å‡º100å€çš„å¢åŠ </span>
    np<span class="token punctuation">.</span>fill_diagonal<span class="token punctuation">(</span>shared_haplogroups_matrix<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
    
    <span class="token comment"># è¿”å›ä¸€ä¸ªæ–°çš„DataFrameï¼Œå…¶ç´¢å¼•å’Œåˆ—éƒ½æ˜¯äººç¾¤åç§°</span>
    <span class="token keyword">return</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>shared_haplogroups_matrix<span class="token punctuation">,</span> index<span class="token operator">=</span>populations<span class="token punctuation">,</span> columns<span class="token operator">=</span>populations<span class="token punctuation">)</span>

<span class="token comment"># ä½¿ç”¨å‡½æ•°è®¡ç®—å…±äº«å•å€ç¾¤çŸ©é˜µ</span>
shared_matrix <span class="token operator">=</span> calculate_shared_haplogroups_matrix<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token comment"># è¾“å‡ºè®¡ç®—å¾—åˆ°çš„å…±äº«å•å€ç¾¤çŸ©é˜µ</span>
shared_matrix<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span>save_path<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'å…±äº«å•å€ç¾¤çŸ©é˜µå·²ç»ä¿å­˜'</span><span class="token punctuation">)</span>

<span class="token comment"># è¯»å–ä¿å­˜çš„æ–‡ä»¶å¹¶ç»˜åˆ¶çƒ­å›¾</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>save_path<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>

sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>df<span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'YlGnBu'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>


</code><button class="copy-code-button">å¤åˆ¶</button></pre></div><div><p dir="auto">æ ¹æ®ä¸Šè¿°çš„ä»£ç å¯ä»¥å¾—åˆ°çŸ©é˜µï¼š</p></div><div><pre class="language-txt" tabindex="0"><code class="language-txt is-loaded">,Ami,Atayal,Bunun,Paiwan,Puyuma,Rukai,Saisiat,Tsou
Ami,1.0,0.12359550561797752,0.1797752808988764,0.2247191011235955,0.10612015721504772,0.14606741573033707,0.16956765861875348,0.2050561797752809
Atayal,0.12359550561797752,1.0,0.09,0.11,0.24187906046976512,0.2,0.3608195902048975,0.1955
Bunun,0.1797752808988764,0.09,1.0,0.12,0.13293353323338333,0.12,0.1634182908545727,0.214
Paiwan,0.2247191011235955,0.11,0.12,1.0,0.07596201899050474,0.13,0.18990504747626186,0.161
Puyuma,0.10612015721504772,0.24187906046976512,0.13293353323338333,0.07596201899050474,1.0,0.16891554222888555,0.17382617382617385,0.21539230384807598
Rukai,0.14606741573033707,0.2,0.12,0.13,0.16891554222888555,1.0,0.1924037981009495,0.192
Saisiat,0.16956765861875348,0.3608195902048975,0.1634182908545727,0.18990504747626186,0.17382617382617385,0.1924037981009495,1.0,0.25037481259370314
Tsou,0.2050561797752809,0.1955,0.214,0.161,0.21539230384807598,0.192,0.25037481259370314,1.0
</code><button class="copy-code-button">å¤åˆ¶</button></pre></div></div></div><div class="heading-wrapper"><h1 data-heading="å¯è§†åŒ–" dir="auto" class="heading" id="å¯è§†åŒ–">å¯è§†åŒ–</h1><div class="heading-children"><div><p dir="auto">éšä¾¿æ‰¾ä¸ªç½‘ç«™æˆ–è€… R ä»£ç ä¹Ÿå¯ä»¥å¯è§†åŒ–ã€‚å…·ä½“å¯çœ‹ <a data-href="Rï¼šFstç»˜åˆ¶é¢‘ç‡çƒ­å›¾çŸ©é˜µ" href="è½¯ä»¶/rè¯­è¨€è¯­æ³•/rï¼šfstç»˜åˆ¶é¢‘ç‡çƒ­å›¾çŸ©é˜µ.html" class="internal-link" target="_self" rel="noopener">Rï¼šFstç»˜åˆ¶é¢‘ç‡çƒ­å›¾çŸ©é˜µ</a>ã€‚<br>
<img alt="Figure_1.png" src="https://picturerealm.oss-cn-chengdu.aliyuncs.com/obsidian/202403262141478.png" referrerpolicy="no-referrer" style="width: 500px; max-width: 100%;"></p></div></div></div><div class="heading-wrapper"><h1 data-heading="å›¾æ³¨" dir="auto" class="heading" id="å›¾æ³¨">å›¾æ³¨</h1><div class="heading-children"><div><blockquote dir="auto">
<p><strong>Figure X.</strong> Pairwise matrix showing the proportion of shared haplogroups between different populations. The matrix is calculated by identifying the minimum count of shared haplogroups between each pair of populations. Each cell in the matrix represents the amount of haplogroups shared between the two populations indicated by the corresponding row and column. Diagonal elements (self-comparisons) are excluded or set to zero. Higher values in the matrix indicate greater genetic similarity in terms of shared haplogroups, while lower values indicate fewer haplogroups in common. Non-shared haplogroups, specific to one population, are not represented in this matrix. The color gradient (or numerical values) illustrates the degree of sharing across populations.</p>
</blockquote></div></div></div><div class="heading-wrapper"><h1 data-heading="è§£è¯»" dir="auto" class="heading" id="è§£è¯»">è§£è¯»</h1><div class="heading-children"><div><p dir="auto">é€šè¿‡è§‚å¯ŸçŸ©é˜µä¸­æ•°å€¼çš„æ•´ä½“åˆ†å¸ƒï¼Œå¯ä»¥è¯†åˆ«å‡ºå…±äº«å•å€ç¾¤çš„æ™®éè¶‹åŠ¿ã€‚æ•°å€¼è¾ƒé«˜çš„åŒºåŸŸæ„å‘³ç€è¿™äº›äººç¾¤ä¹‹é—´æœ‰æ›´å¤šçš„é—ä¼ ç›¸ä¼¼æ€§ï¼Œåä¹‹åˆ™è¯´æ˜é—ä¼ å·®å¼‚è¾ƒå¤§ã€‚</p></div><div><div data-callout-metadata="" data-callout-fold="" data-callout="bug" class="callout"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-bug"><path d="m8 2 1.88 1.88"></path><path d="M14.12 3.88 16 2"></path><path d="M9 7.13v-1a3.003 3.003 0 1 1 6 0v1"></path><path d="M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6"></path><path d="M12 20v-9"></path><path d="M6.53 9C4.6 8.8 3 7.1 3 5"></path><path d="M6 13H2"></path><path d="M3 21c0-2.1 1.7-3.9 3.8-4"></path><path d="M20.97 5c0 2.1-1.6 3.8-3.5 4"></path><path d="M22 13h-4"></path><path d="M17.2 17c2.1.1 3.8 1.9 3.8 4"></path></svg></div><div class="callout-title-inner">ä¸€ä¸ªéœ€è¦æ³¨æ„çš„é—®é¢˜æ˜¯å…±äº«å•å€ç¾¤çš„è®¡ç®—åŸºäº<strong>å•å€ç¾¤</strong>ï¼Œè€Œéåºåˆ—ã€‚è¿™åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå—é™äºå¯¹å•å€ç¾¤çš„å®šä¹‰ã€‚</div></div><div class="callout-content">
<p dir="auto">ä¸å»ºè®®ç”Ÿæˆèšç±»æ ‘ï¼ˆç»“æœéš¾ä»¥è§£é‡Šï¼‰ã€‚<br>
å»ºè®®å°†å…±äº«å•å€ç¾¤çŸ©é˜µå’ŒæŸ±çŠ¶å›¾è”åˆèµ·æ¥è¿›è¡Œè§£é‡Šå’Œè§£è¯»ã€‚é‡ç‚¹åœ¨äº<strong>æŸ±çŠ¶å›¾</strong>ã€‚<a data-href="pythonï¼šæ ¹æ®å…±äº«å•å€ç¾¤é¢‘ç‡ç»˜åˆ¶äººç¾¤æŸ±çŠ¶å›¾" href="è½¯ä»¶/python/æ•°æ®ç§‘å­¦ä¸æ ¼å¼è½¬æ¢/pythonï¼šæ ¹æ®å…±äº«å•å€ç¾¤é¢‘ç‡ç»˜åˆ¶äººç¾¤æŸ±çŠ¶å›¾.html" class="internal-link" target="_self" rel="noopener">pythonï¼šæ ¹æ®å…±äº«å•å€ç¾¤é¢‘ç‡ç»˜åˆ¶äººç¾¤æŸ±çŠ¶å›¾</a>ã€‚</p>
</div></div></div><div class="mod-footer"></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="è½¯ä»¶\python\æ•°æ®ç§‘å­¦ä¸æ ¼å¼è½¬æ¢\pythonï¼šæ ¹æ®å…±äº«å•å€ç¾¤é¢‘ç‡ç»˜åˆ¶äººç¾¤çƒ­å›¾.html#åŸç†"><div class="tree-item-contents heading-link" heading-name="åŸç†"><span class="tree-item-title">åŸç†</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="è½¯ä»¶\python\æ•°æ®ç§‘å­¦ä¸æ ¼å¼è½¬æ¢\pythonï¼šæ ¹æ®å…±äº«å•å€ç¾¤é¢‘ç‡ç»˜åˆ¶äººç¾¤çƒ­å›¾.html#æ•°æ®å‡†å¤‡"><div class="tree-item-contents heading-link" heading-name="æ•°æ®å‡†å¤‡"><span class="tree-item-title">æ•°æ®å‡†å¤‡</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="è½¯ä»¶\python\æ•°æ®ç§‘å­¦ä¸æ ¼å¼è½¬æ¢\pythonï¼šæ ¹æ®å…±äº«å•å€ç¾¤é¢‘ç‡ç»˜åˆ¶äººç¾¤çƒ­å›¾.html#ä»£ç å®ç°"><div class="tree-item-contents heading-link" heading-name="ä»£ç å®ç°"><span class="tree-item-title">ä»£ç å®ç°</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="è½¯ä»¶\python\æ•°æ®ç§‘å­¦ä¸æ ¼å¼è½¬æ¢\pythonï¼šæ ¹æ®å…±äº«å•å€ç¾¤é¢‘ç‡ç»˜åˆ¶äººç¾¤çƒ­å›¾.html#å¯è§†åŒ–"><div class="tree-item-contents heading-link" heading-name="å¯è§†åŒ–"><span class="tree-item-title">å¯è§†åŒ–</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="è½¯ä»¶\python\æ•°æ®ç§‘å­¦ä¸æ ¼å¼è½¬æ¢\pythonï¼šæ ¹æ®å…±äº«å•å€ç¾¤é¢‘ç‡ç»˜åˆ¶äººç¾¤çƒ­å›¾.html#å›¾æ³¨"><div class="tree-item-contents heading-link" heading-name="å›¾æ³¨"><span class="tree-item-title">å›¾æ³¨</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="è½¯ä»¶\python\æ•°æ®ç§‘å­¦ä¸æ ¼å¼è½¬æ¢\pythonï¼šæ ¹æ®å…±äº«å•å€ç¾¤é¢‘ç‡ç»˜åˆ¶äººç¾¤çƒ­å›¾.html#è§£è¯»"><div class="tree-item-contents heading-link" heading-name="è§£è¯»"><span class="tree-item-title">è§£è¯»</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>